{
    "title": "avro-schema",
    "description": "JSON Schema for an Apache Avro schema, version 1.7.3",
    "oneOf": [
        { "$ref": "#/definitions/primitiveTypes" },
        {
            "type": "object",
            "required": [ "type" ],
            "properties": {
                "type": { "$ref": "#/definitions/primitiveTypes" }
            }
        },
        { "$ref": "#/definitions/record" },
        { "$ref": "#/definitions/enum" },
        { "$ref": "#/definitions/array" },
        { "$ref": "#/definitions/map" },
        { "$ref": "#/definitions/union" },
        { "$ref": "#/definitions/fixed" }
    ],
    "definitions": {
        "primitiveTypes": {
            "description": "One primitive type",
            "enum": [ "null", "boolean", "int", "long", "float", "double", "bytes", "string" ]
        },
        "record": {
            "description": "A record",
            "type": "object",
            "required": [ "type", "name", "fields" ],
            "properties": {
                "type": { "enum": [ "record" ] },
                "name": { "$ref": "#/definitions/name" },
                "namespace": { "$ref": "#/definitions/namespace" },
                "doc": { "type": "string" },
                "aliases": { "$ref": "#/definitions/aliases" },
                "fields": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/field" }
                }
            }
        },
        "enum": {
            "description": "an enum as defined by the Avro specification",
            "type": "object",
            "required": [ "type", "name", "symbols" ],
            "properties": {
                "type": { "enum": [ "enum" ] },
                "name": { "$ref": "#/definitions/name" },
                "namespace": { "$ref": "#/definitions/namespace" },
                "aliases": { "$ref": "#/definitions/aliases" },
                "doc": { "type": "string" },
                "symbols": {
                    "type": "array",
                    "minItems": 1,
                    "items": { "type": "string" },
                    "uniqueItems": true
                }
            }
        },
        "array": {
            "description": "An array as defined by the Avro specification",
            "notes": [ "spec doesn't say whether \"items\" is required!" ],
            "type": "object",
            "required": [ "type" ],
            "properties": {
                "type": { "enum": [ "array" ] },
                "items": { "$ref": "#" }
            }
        },
        "map": {
            "description": "A map as defined by the Avro specification",
            "notes": [ "spec doesn't say whether \"values\" is required!" ],
            "type": "object",
            "required": [ "type" ],
            "properties": {
                "type": { "enum": [ "map" ] },
                "values": { "$ref": "#" }
            }
        },
        "union": {
            "description": "A union of schemas",
            "type": "array",
            "uniqueItems": true,
            "items": {
                "allOf": [
                    { "$ref": "#" },
                    { "not": { "$ref": "#/definitions/union" } }
                ]
            }
        },
        "fixed": {
            "description": "A fixed type, as defined by the Avro specification",
            "type": "object",
            "required": [ "type", "name", "size" ],
            "properties": {
                "type": { "enum": [ "fixed" ] },
                "name": { "$ref": "#/definitions/name" },
                "namespace": { "$ref": "#/definitions/namespace" },
                "size": {
                    "type": "integer",
                    "minimum": 0,
                    "exclusiveMinimum": true
                },
                "aliases": { "$ref": "#/definitions/aliases" }
            }
        },
        "name": {
            "description": "what a name can be",
            "type": "string",
            "pattern": "^[A-Za-z_][A-Za-z0-9_]+$"
        },
        "namespace": {
            "description": "what a namespace can be",
            "type": "string",
            "pattern": "^[A-Za-z_][A-Za-z0-9_](\\.[A-Za-z_][A-Za-z0-9_])+$"
        },
        "aliases": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
                "oneOf": [
                    { "$ref": "#/definitions/name" },
                    { "$ref": "#/definitions/namespace" } ]
            }
        },
        "field": {
            "description": "One field in a record",
            "type": "object",
            "required": [ "name", "type" ],
            "properties": {
                "name": { "$ref": "#/definitions/name" },
                "doc": { "type": "string" },
                "type": {
                    "notes": [
                        "spec says \"a JSON Object defining a schema or a JSON string naming a record definition\"",
                        "what is a record definition??"
                    ],
                    "oneOf": [
                        { "type": "string" },
                        {
                            "allOf": [
                                { "$ref": "#" },
                                { "not": { "$ref": "#/definitions/primitiveTypes" } }
                            ]
                        }
                    ]
                },
                "default": {
                    "description": "default value, depending on the type"
                },
                "order": {
                    "enum": [ "ascending", "descending", "ignore" ]
                },
                "aliases": { "$ref": "#/definitions/aliases" }
            }
        }
    }
}